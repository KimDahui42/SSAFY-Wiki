# TLS / SSL handshake

태그: 네트워크
CS 주제: [7주차]네트워크 (https://www.notion.so/7-e6ca97c373c84b8ebecba434de0b9e95?pvs=21)
날짜: 2023년 9월 11일
블로그 게시: Yes
완료: Yes
작성자: 김지연
참고자료: https://www.cloudflare.com/ko-kr/learning/ssl/transport-layer-security-tls/
출석: 230911 출석 (https://www.notion.so/230911-57918bcc3f5d44d09a8caaba8fca46c6?pvs=21)

> TLS transport layer security
> 

인터넷 상의 커뮤니케이션에 있어 개인정보와 데이터 보안을 용이하게 하기 위해 설계된 보안 프로토콜

> SSL secure sockets layer
> 

암호화 기반 인터넷 보안 프로토콜. → **SSL 인증서**: 클라이언트와 서버간의 통신을 제 3자가 보증해주는 전자화된 문서

TLS 는 SSL 가 발전한 것.  =  SSL 은 TLS 의 전신.

> TLS 가 하는 일
> 
- 암호화: 제3자로부터 전송되는 데이터를 숨긴다
- 인증: 정보를 교환하는 당사자가 요청된 당사자임을 보장한다.
- 무결성: 데이터가 위조되거나 변조되지 않았는지 확인한다

> TLS Handshake
> 

TLS 암호화를 사용하는 통신 세션을 실행하는 프로세스.

HTTPS 작동 원리의 근간을 이룬다.

☆ 모든 TLS handshake 가 비대칭 암호화를 사용한다.

SSL 인증서로 신뢰성을 판단하기 위해 공개키 서명 방식을 사용한다.

→  이때 방식을 TLS handshake라고 함.

> TLS Handshake 의 발생 시점
> 
- 사용자가 HTTPS 를 통해 웹사이트를 탐색하고 브라우저가 처음 해당 웹 사이트의 원본 서버를 쿼리하기 시작할 때 발생.
- 다른 통신이 **API 호출** 및 HTTPS를 통한 **DNS 쿼리를 포함하는 HTTPS 를 사용**할 때 발생.

> TLS handshake 과정
> 

1. **client hello** 메시지 : 핸드셰이크 개시.

- 클라이언트가 지원하는 [TLS버전], 지원되는 [암호 제품군]과 [클라이언트 무작위](무작위 바이트 문자열)이 포함되어 있다.

2. **server hello** 메시지: 클라이언트 헬로에 대한 응답.

- 서버의 [SSL 인증서], 서버에서 선택한 [암호 제품군], [서버 무작위] (무작위 바이트 문자열)

3. **인증** : 클라이언트가 서버의 SSL 인증서를 검증.

- 서버가 인증서에 명시된 서버인지, 클라이언트가 상호작용 중인 서버가 실제 해당 도메인 소유자인지 확인

4. **예비 마스터 암호**: 클라이언트가 **예비 마스터 암호**를 하나 더 전송 (무작위 바이트 문자열)

- 공개키로 암호화되어 있어 서버가 개인키로만 해독 가능

5. **개인 키 사용**: 서버가 예비 마스터 암호를 해독합니다.

6. **세션 키 생성**: 클라이언트와 서버가 세션 키 생성

- 둘 다 [클라이언트 무작위], [서버 무작위], [예비 마스터 암호]를 이용
- 모두 같은 결과가 나와야 함

7. **클라이언트 준비 완료** : 클라이언트가 세션 키로 암호화된 "완료" 메시지 전송

8. **서버 준비 완료**: 서버가 세션 키로 암호화된 "완료" 메시지 전송

9. **안전한 대칭 암호화 성공** : handshake 완료. 세션 키를 이용해 통신이 계속 진행
